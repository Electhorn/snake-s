(function(){const n=document.createElement("link").relList;if(n&&n.supports&&n.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))s(i);new MutationObserver(i=>{for(const a of i)if(a.type==="childList")for(const c of a.addedNodes)c.tagName==="LINK"&&c.rel==="modulepreload"&&s(c)}).observe(document,{childList:!0,subtree:!0});function e(i){const a={};return i.integrity&&(a.integrity=i.integrity),i.referrerPolicy&&(a.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?a.credentials="include":i.crossOrigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function s(i){if(i.ep)return;i.ep=!0;const a=e(i);fetch(i.href,a)}})();const ie={difficulty:{easy:10,medium:15,hard:22}},se="easy",C=18,ae=2,re=5,ce=.05,D=1.2,G=1,F="snakeHighScore";let x,b,N,X,U,k,$,q,V,T,p,K,j,z;function le(){x=document.getElementById("scoreValue"),b=document.getElementById("highScoreValue"),N=document.getElementById("menuOverlay"),X=document.getElementById("playButton"),U=document.querySelector(".menu-options"),k=document.getElementById("pauseOverlay"),$=document.getElementById("gameInfo"),q=document.getElementById("resumeButton"),V=document.getElementById("restartFromPauseButton"),T=document.getElementById("gameOverOverlay"),p=document.getElementById("gameOverTitle"),K=document.getElementById("finalScores"),j=document.getElementById("playAgainButton"),z=document.getElementById("mainMenuButton")}function de(t,n){X.addEventListener("click",t),U.addEventListener("click",e=>{if(e.target.tagName==="BUTTON"){const{setting:s,value:i}=e.target.dataset;e.target.parentElement.querySelectorAll("button").forEach(c=>c.classList.remove("active")),e.target.classList.add("active"),n(s,i)}})}function ue(){N.classList.remove("hidden")}function fe(){N.classList.add("hidden")}function Z(t){x.textContent=t}function J(t){b.textContent=t}function he(t,n){q.addEventListener("click",t),V.addEventListener("click",n)}function ge(){k.classList.remove("hidden")}function Q(){k.classList.add("hidden")}function me(t){const n=t.difficulty.charAt(0).toUpperCase()+t.difficulty.slice(1);$.innerHTML=`<div>Dificultad: <span>${n}</span></div>`}function pe(t,n){j.addEventListener("click",t),z.addEventListener("click",n)}function ye(t,n,e){e?(p.textContent="¡Nuevo Récord!",p.classList.add("new-record")):(p.textContent="¡Has perdido!",p.classList.remove("new-record")),K.innerHTML=`
    <div>Puntuación: <span>${t}</span></div>
    <div>Mejor: <span>${n}</span></div>
  `,T.classList.remove("hidden")}function ee(){T.classList.add("hidden")}let r=[],h=0,g=0,I=!1;function Ee(t,n,e){const s=t*e,i=n*e;r=[];for(let a=0;a<3;a++){const c=s-a*e;r.push({x:c,y:i,prevX:c,prevY:i})}h=e,g=0,I=!1}function ve(t){I=!1;for(const e of r)e.prevX=e.x,e.prevY=e.y;for(let e=r.length-1;e>0;e--)r[e].x=r[e-1].x,r[e].y=r[e-1].y;const n=r[0];if(n.x+=h,n.y+=g,t){const e=r[r.length-1];r.push({x:e.prevX,y:e.prevY,prevX:e.prevX,prevY:e.prevY})}}function Se(t,n,e){r.forEach((s,i)=>{const a=s.prevX+(s.x-s.prevX)*e,c=s.prevY+(s.y-s.prevY)*e,v=i===0?"#1ABC9C":"#48C9B0";t.fillStyle=v,t.fillRect(a,c,n,n),i===0&&Ie(t,n,a,c)})}function Ie(t,n,e,s){t.fillStyle="white";const i=Math.max(2,Math.floor(n/5));h>0?(t.fillRect(e+n-i*2,s+i,i,i),t.fillRect(e+n-i*2,s+n-i*2,i,i)):h<0?(t.fillRect(e+i,s+i,i,i),t.fillRect(e+i,s+n-i*2,i,i)):g>0?(t.fillRect(e+i,s+n-i*2,i,i),t.fillRect(e+n-i*2,s+n-i*2,i,i)):g<0&&(t.fillRect(e+i,s+i,i,i),t.fillRect(e+n-i*2,s+i,i,i))}function Le(t,n,e){if(I)return!1;const s=g===-e,i=g===e,a=h===e,c=h===-e;return n===-e&&i||n===e&&s||t===-e&&a||t===e&&c?!1:(h=t,g=n,I=!0,!0)}function Me(t,n){const e=r[0];if(e.x<0||e.x>=t||e.y<0||e.y>=n)return!0;for(let s=1;s<r.length;s++)if(r[s].x===e.x&&r[s].y===e.y)return!0;return!1}function we(){return r[0]}function te(){return r}let L,M,d=1,H=1;function ne(t,n,e,s){let i;do{i=!1;const a=Math.floor(Math.random()*e),c=Math.floor(Math.random()*s);L=a*t,M=c*t;for(const v of n)if(v.x===L&&v.y===M){i=!0;break}}while(i);d=1,H=1}function Pe(){d+=H*ce,(d>D||d<G)&&(H*=-1,d=Math.max(G,Math.min(d,D)))}function Ce(t,n){const e=n*d,s=(n-e)/2,i=(n-e)/2;t.fillStyle="#E74C3C",t.fillRect(L+s,M+i,e,e)}function He(){return{x:L,y:M}}let A=null,B=null,w=0,P=0,S=!1;const _=30;function O(t,n){A&&A(t,n)}function Ae(t){const n=t.key.toLowerCase();if(n==="escape"){B&&B();return}let e=null,s=null;n==="arrowup"||n==="w"?(e=0,s=-1):n==="arrowdown"||n==="s"?(e=0,s=1):n==="arrowleft"||n==="a"?(e=-1,s=0):(n==="arrowright"||n==="d")&&(e=1,s=0),e!==null&&O(e,s)}function Be(t){t.preventDefault();const n=t.touches[0];w=n.clientX,P=n.clientY,S=!1}function Oe(t){if(t.preventDefault(),!w||!P||S)return;const n=t.touches[0],e=n.clientX-w,s=n.clientY-P;Math.abs(e)>Math.abs(s)?Math.abs(e)>_&&(O(e>0?1:-1,0),S=!0):Math.abs(s)>_&&(O(0,s>0?1:-1),S=!0)}function Ne(t){t.preventDefault(),w=0,P=0}function ke(){const t=document.getElementById("gameContainer");t&&(t.addEventListener("touchstart",Be,{passive:!1}),t.addEventListener("touchmove",Oe,{passive:!1}),t.addEventListener("touchend",Ne,{passive:!1}))}function Te(t,n){A=t,B=n,document.addEventListener("keydown",Ae),ke()}let E=[];const Re=2.5,De=.05,Ge=3;function _e(t,n,e){E.push({x:t+e/2,y:n+e/2,radius:e/4,alpha:1,color:"#E74C3C"})}function We(){for(let t=E.length-1;t>=0;t--){const n=E[t];n.radius+=Re,n.alpha-=De,n.alpha<=0&&E.splice(t,1)}}function Ye(t){E.forEach(n=>{t.beginPath(),t.strokeStyle=`rgba(231, 76, 60, ${n.alpha})`,t.lineWidth=Ge*n.alpha,t.arc(n.x,n.y,n.radius,0,Math.PI*2),t.stroke()})}const u=document.getElementById("gameCanvas"),W=document.getElementById("gameContainer"),l=u.getContext("2d"),o={score:0,snakeSpeed:0,highScore:0,box:C,gridWidth:0,gridHeight:0,status:"MENU",newHighScore:!1,options:{difficulty:se}};let f=0,m=0;function Fe(){le(),de(be,xe),he(Y,y),pe(Xe,y),Te(Ue,Y),window.addEventListener("resize",y),y(),window.requestAnimationFrame(oe)}function xe(t,n){o.options[t]!==void 0&&(o.options[t]=n,y())}function be(){o.status="PLAYING",fe(),R(),f=0,m=0}function Xe(){ee(),o.status="PLAYING",R(),f=0,m=0}function y(){o.status!=="MENU"&&(o.status="MENU",ue()),Q(),ee();const t=W.clientWidth,n=W.clientHeight,e=window.devicePixelRatio||1;o.gridWidth=Math.floor(t/C),o.gridHeight=Math.floor(n/C);const s=t/o.gridWidth,i=n/o.gridHeight;o.box=Math.floor(Math.min(s,i));const a=o.gridWidth*o.box,c=o.gridHeight*o.box;u.width=a*e,u.height=c*e,u.style.width=`${a}px`,u.style.height=`${c}px`,l.resetTransform(),l.scale(e,e),o.highScore=Ke(),J(o.highScore),R()}function R(){o.score=0,o.snakeSpeed=ie.difficulty[o.options.difficulty],o.newHighScore=!1,Z(o.score);const t=Math.floor(o.gridWidth/2),n=Math.floor(o.gridHeight/2);Ee(t,n,o.box),ne(o.box,te(),o.gridWidth,o.gridHeight)}function oe(t){if(window.requestAnimationFrame(oe),f===0){f=t;return}const n=t-f;if(f=t,o.status==="PLAYING"){m+=n;const s=1e3/o.snakeSpeed;m>=s&&(m%=s,$e())}const e=o.status==="PLAYING"?m/(1e3/o.snakeSpeed):1;Ve(e)}function Y(){o.status==="PLAYING"?(o.status="PAUSED",me(o.options),ge()):o.status==="PAUSED"&&(o.status="PLAYING",Q(),f=0)}function Ue(t,n){o.status==="PLAYING"&&Le(t*o.box,n*o.box,o.box)}function $e(){We();const t=o.gridWidth*o.box,n=o.gridHeight*o.box;if(Me(t,n)){je(),o.status="GAME_OVER",ye(o.score,o.highScore,o.newHighScore);return}const e=we(),s=He(),i=e.x===s.x&&e.y===s.y;ve(i),i&&(_e(s.x,s.y,o.box),o.score++,Z(o.score),o.score>0&&o.score%re===0&&(o.snakeSpeed+=ae),ne(o.box,te(),o.gridWidth,o.gridHeight)),Pe()}function qe(){const t=o.gridWidth*o.box,n=o.gridHeight*o.box;l.strokeStyle="#2C3E50",l.lineWidth=1/(window.devicePixelRatio||1);for(let e=0;e<=t;e+=o.box)l.beginPath(),l.moveTo(e,0),l.lineTo(e,n),l.stroke();for(let e=0;e<=n;e+=o.box)l.beginPath(),l.moveTo(0,e),l.lineTo(t,e),l.stroke()}function Ve(t=1){const n=u.width/(window.devicePixelRatio||1),e=u.height/(window.devicePixelRatio||1);l.clearRect(0,0,n,e),qe(),o.status!=="MENU"&&(Ce(l,o.box),Se(l,o.box,t)),Ye(l)}function Ke(){return parseInt(localStorage.getItem(F)||"0",10)}function je(){o.score>o.highScore&&(o.highScore=o.score,localStorage.setItem(F,o.highScore),o.newHighScore=!0,J(o.highScore))}const ze=document.querySelector("body");ze?Fe():console.error("No se encontró el elemento principal de la aplicación.");
